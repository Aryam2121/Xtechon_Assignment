# ğŸ—ï¸ System Architecture

Visual representation of the Flight Booking System architecture.

---

## ğŸ“Š High-Level Architecture

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                         CLIENT BROWSER                          â”‚
â”‚                     (http://localhost:3000)                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”‚ HTTP/AXIOS
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      REACT FRONTEND                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚   Search     â”‚  â”‚   Booking    â”‚  â”‚    Navbar    â”‚        â”‚
â”‚  â”‚   Flights    â”‚  â”‚   History    â”‚  â”‚              â”‚        â”‚
â”‚  â”‚    Page      â”‚  â”‚    Page      â”‚  â”‚              â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚  FlightCard  â”‚  â”‚ BookingCard  â”‚  â”‚   Wallet     â”‚        â”‚
â”‚  â”‚  Component   â”‚  â”‚  Component   â”‚  â”‚   Context    â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â”‚                                                                  â”‚
â”‚              â””â”€â”€â”€â”€â”€â”€â”€â”€ API Service (Axios) â”€â”€â”€â”€â”€â”€â”€â”€â”˜           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”‚ REST API
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    EXPRESS.JS BACKEND                           â”‚
â”‚                  (http://localhost:5000)                        â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                      ROUTES                              â”‚  â”‚
â”‚  â”‚  /api/flights  â”‚  /api/bookings  â”‚  /api/wallet        â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                         â”‚                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                   CONTROLLERS                            â”‚  â”‚
â”‚  â”‚  flightController  â”‚  bookingController  â”‚ walletCtrl   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                         â”‚                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                     MODELS                               â”‚  â”‚
â”‚  â”‚  Flight  â”‚  Booking  â”‚  Wallet  â”‚  PricingTracker       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                         â”‚                                        â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚                  UTILITIES                               â”‚  â”‚
â”‚  â”‚         pdfGenerator.js  â”‚  helpers.js                   â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                         â”‚
                         â”‚ Mongoose ODM
                         â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                      MONGODB DATABASE                           â”‚
â”‚                  (mongodb://localhost:27017)                    â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚
â”‚  â”‚  flights   â”‚  â”‚  bookings  â”‚  â”‚  wallets   â”‚              â”‚
â”‚  â”‚ (20 docs)  â”‚  â”‚            â”‚  â”‚            â”‚              â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚
â”‚                                                                  â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                                        â”‚
â”‚  â”‚  pricingtrackers   â”‚                                        â”‚
â”‚  â”‚                    â”‚                                        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                                        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ Request Flow Diagram

### Booking a Flight

```
1. USER CLICKS "BOOK NOW"
   â”‚
   â”œâ”€â–¶ FlightCard Component
   â”‚
2. TRACK BOOKING ATTEMPT
   â”‚
   â”œâ”€â–¶ POST /api/flights/track-attempt
   â”‚   â”‚
   â”‚   â”œâ”€â–¶ flightController.trackBookingAttempt()
   â”‚   â”‚   â”‚
   â”‚   â”‚   â”œâ”€â–¶ Find/Create PricingTracker
   â”‚   â”‚   â”œâ”€â–¶ Add timestamp to attempts
   â”‚   â”‚   â”œâ”€â–¶ Check if 3 attempts in 5 min
   â”‚   â”‚   â”œâ”€â–¶ Apply 10% surge if needed
   â”‚   â”‚   â””â”€â–¶ Return current price
   â”‚   â”‚
   â”‚   â””â”€â–¶ Response: { current_price, surge_percentage }
   â”‚
3. USER ENTERS NAME & CONFIRMS
   â”‚
   â”œâ”€â–¶ POST /api/bookings/create
   â”‚   â”‚
   â”‚   â”œâ”€â–¶ bookingController.createBooking()
   â”‚   â”‚   â”‚
   â”‚   â”‚   â”œâ”€â–¶ Get flight details (Flight model)
   â”‚   â”‚   â”œâ”€â–¶ Calculate final price (with surge)
   â”‚   â”‚   â”œâ”€â–¶ Check wallet balance (Wallet model)
   â”‚   â”‚   â”‚   â”‚
   â”‚   â”‚   â”‚   â”œâ”€â–¶ IF insufficient: Return error
   â”‚   â”‚   â”‚   â””â”€â–¶ IF sufficient: Continue
   â”‚   â”‚   â”‚
   â”‚   â”‚   â”œâ”€â–¶ Deduct from wallet
   â”‚   â”‚   â”œâ”€â–¶ Create booking (Booking model)
   â”‚   â”‚   â”œâ”€â–¶ Generate PNR (helpers.generatePNR)
   â”‚   â”‚   â”œâ”€â–¶ Generate PDF (pdfGenerator.generateTicketPDF)
   â”‚   â”‚   â”‚   â”‚
   â”‚   â”‚   â”‚   â””â”€â–¶ Save to backend/tickets/
   â”‚   â”‚   â”‚
   â”‚   â”‚   â””â”€â–¶ Return booking + wallet balance
   â”‚   â”‚
   â”‚   â””â”€â–¶ Response: { booking, wallet_balance, pdf_generated }
   â”‚
4. UPDATE UI
   â”‚
   â”œâ”€â–¶ Show success message
   â”œâ”€â–¶ Refresh wallet balance (WalletContext)
   â””â”€â–¶ Allow PDF download
```

---

## ğŸ—„ï¸ Database Schema Relationships

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     flights      â”‚
â”‚                  â”‚
â”‚  flight_id (PK)  â”‚â—€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  airline         â”‚          â”‚
â”‚  departure_city  â”‚          â”‚  Reference
â”‚  arrival_city    â”‚          â”‚
â”‚  base_price      â”‚          â”‚
â”‚  times...        â”‚          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜          â”‚
                              â”‚
                              â”‚
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”          â”‚
â”‚    bookings      â”‚          â”‚
â”‚                  â”‚          â”‚
â”‚  pnr (PK)        â”‚          â”‚
â”‚  passenger_name  â”‚          â”‚
â”‚  flight_id (FK)  â”‚â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚  final_price     â”‚
â”‚  booking_date    â”‚
â”‚  flight details  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚     wallets      â”‚
â”‚                  â”‚
â”‚  user_id (PK)    â”‚
â”‚  balance         â”‚
â”‚  transactions[]  â”‚
â”‚    - type        â”‚
â”‚    - amount      â”‚
â”‚    - description â”‚
â”‚    - date        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜


â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  pricingtrackers    â”‚
â”‚                     â”‚
â”‚  flight_id (FK)     â”‚â”€â”€â”
â”‚  booking_attempts[] â”‚  â”‚  Track surge
â”‚  surge_percentage   â”‚  â”‚  pricing per
â”‚  surge_applied_at   â”‚  â”‚  flight
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
         â”‚               â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       One tracker per flight
```

---

## ğŸ“¡ API Endpoint Structure

```
/api
â”‚
â”œâ”€â”€ /flights
â”‚   â”‚
â”‚   â”œâ”€â”€ GET  /search
â”‚   â”‚        Query: departure_city, arrival_city
â”‚   â”‚        Returns: Array of flights with current pricing
â”‚   â”‚
â”‚   â””â”€â”€ POST /track-attempt
â”‚            Body: { flight_id }
â”‚            Returns: Updated price with surge info
â”‚
â”œâ”€â”€ /bookings
â”‚   â”‚
â”‚   â”œâ”€â”€ POST /create
â”‚   â”‚        Body: { passenger_name, flight_id }
â”‚   â”‚        Returns: Booking + PDF generated
â”‚   â”‚
â”‚   â”œâ”€â”€ GET  /history
â”‚   â”‚        Returns: All bookings (sorted by date)
â”‚   â”‚
â”‚   â””â”€â”€ GET  /download/:pnr
â”‚            Params: pnr
â”‚            Returns: PDF file (download)
â”‚
â””â”€â”€ /wallet
    â”‚
    â”œâ”€â”€ GET  /balance
    â”‚        Returns: Current balance + transactions
    â”‚
    â””â”€â”€ POST /add-money
             Body: { amount }
             Returns: Updated balance
```

---

## ğŸ§© Component Hierarchy (Frontend)

```
App.jsx
â”‚
â”œâ”€â”€ WalletProvider (Context)
â”‚   â”‚
â”‚   â””â”€â”€ Router
â”‚       â”‚
â”‚       â”œâ”€â”€ Navbar
â”‚       â”‚   â””â”€â”€ Displays: Logo, Nav Links, Wallet Balance
â”‚       â”‚
â”‚       â””â”€â”€ Routes
â”‚           â”‚
â”‚           â”œâ”€â”€ Route: "/"
â”‚           â”‚   â”‚
â”‚           â”‚   â””â”€â”€ SearchFlights Page
â”‚           â”‚       â”œâ”€â”€ Search Form
â”‚           â”‚       â”‚   â”œâ”€â”€ Departure Input
â”‚           â”‚       â”‚   â”œâ”€â”€ Arrival Input
â”‚           â”‚       â”‚   â””â”€â”€ Search/Reset Buttons
â”‚           â”‚       â”‚
â”‚           â”‚       â””â”€â”€ Flight Results
â”‚           â”‚           â””â”€â”€ FlightCard (multiple)
â”‚           â”‚               â”œâ”€â”€ Flight Details
â”‚           â”‚               â”œâ”€â”€ Pricing (with surge badge)
â”‚           â”‚               â””â”€â”€ Booking Form
â”‚           â”‚                   â”œâ”€â”€ Passenger Input
â”‚           â”‚                   â””â”€â”€ Confirm/Cancel
â”‚           â”‚
â”‚           â””â”€â”€ Route: "/bookings"
â”‚               â”‚
â”‚               â””â”€â”€ BookingHistory Page
â”‚                   â””â”€â”€ BookingCard (multiple)
â”‚                       â”œâ”€â”€ Booking Details
â”‚                       â””â”€â”€ Download Button
```

---

## âš¡ Dynamic Pricing State Machine

```
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚   NORMAL STATE  â”‚
                   â”‚  Price = Base   â”‚
                   â”‚  Surge = 0%     â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚ User clicks "Book Now"
                            â”‚
                            â–¼
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚  TRACK ATTEMPT  â”‚
                   â”‚  Add timestamp  â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                           â”‚
              â”‚ < 3 attempts              â”‚ >= 3 attempts
              â”‚ in 5 min?                 â”‚ in 5 min?
              â”‚                           â”‚
              â–¼                           â–¼
     â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
     â”‚  NORMAL STATE   â”‚        â”‚   SURGE STATE   â”‚
     â”‚  Price = Base   â”‚        â”‚ Price = Base*1.1â”‚
     â”‚  Surge = 0%     â”‚        â”‚  Surge = 10%    â”‚
     â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚                           â”‚
              â”‚                           â”‚
              â”‚                           â”‚ Wait 10 minutes
              â”‚                           â”‚
              â”‚                           â–¼
              â”‚                  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                  â”‚  AUTO RESET     â”‚
              â”‚                  â”‚  Clear attempts â”‚
              â”‚                  â”‚  Surge = 0%     â”‚
              â”‚                  â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
              â”‚                           â”‚
              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ” Data Flow: Wallet Transaction

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    BOOKING REQUEST                           â”‚
â”‚                 (with flight_id, name)                       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  Calculate Price     â”‚
            â”‚  (base + surge)      â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â–¼
            â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
            â”‚  Query Wallet        â”‚
            â”‚  Get current balance â”‚
            â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                       â”‚
                       â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                           â”‚
         â”‚ Balance >= Price?         â”‚
         â”‚                           â”‚
         â”‚                           â”‚
    NO   â”‚                           â”‚   YES
         â”‚                           â”‚
         â–¼                           â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  REJECT BOOKING â”‚        â”‚  ACCEPT BOOKING â”‚
â”‚  Return error   â”‚        â”‚                 â”‚
â”‚  Show: Need â‚¹X  â”‚        â”‚  1. Deduct $    â”‚
â”‚  Have â‚¹Y        â”‚        â”‚  2. Add tx log  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚  3. Save wallet â”‚
                           â”‚  4. Create book â”‚
                           â”‚  5. Generate PDFâ”‚
                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                    â”‚
                                    â–¼
                           â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                           â”‚ RETURN SUCCESS  â”‚
                           â”‚  + New balance  â”‚
                           â”‚  + Booking info â”‚
                           â”‚  + PDF path     â”‚
                           â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“„ PDF Generation Flow

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚      Booking Created in DB           â”‚
â”‚   (with PNR, passenger, flight)      â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â–¼
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚  pdfGenerator.js    â”‚
         â”‚  generateTicketPDF()â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                   â”‚
                   â”œâ”€â”€â–¶ Create PDF Document (PDFKit)
                   â”‚
                   â”œâ”€â”€â–¶ Add Header (âœˆï¸ FLIGHT TICKET)
                   â”‚
                   â”œâ”€â”€â–¶ Add PNR Box
                   â”‚
                   â”œâ”€â”€â–¶ Add Passenger Details
                   â”‚
                   â”œâ”€â”€â–¶ Add Flight Information
                   â”‚
                   â”œâ”€â”€â–¶ Add Route (From â†’ To)
                   â”‚
                   â”œâ”€â”€â–¶ Add Booking Date & Price
                   â”‚
                   â”œâ”€â”€â–¶ Add Footer (Terms)
                   â”‚
                   â”œâ”€â”€â–¶ Save to: tickets/ticket_{PNR}.pdf
                   â”‚
                   â””â”€â”€â–¶ Return file path
                         â”‚
                         â–¼
                â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                â”‚  PDF File Created  â”‚
                â”‚  Ready to download â”‚
                â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ”„ State Management Flow (React Context)

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                   App.jsx (Root)                        â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚          WalletProvider (Context)                  â”‚â”‚
â”‚  â”‚                                                     â”‚â”‚
â”‚  â”‚  State:                                            â”‚â”‚
â”‚  â”‚    - balance: Number                               â”‚â”‚
â”‚  â”‚    - loading: Boolean                              â”‚â”‚
â”‚  â”‚                                                     â”‚â”‚
â”‚  â”‚  Methods:                                          â”‚â”‚
â”‚  â”‚    - fetchBalance(): Async                         â”‚â”‚
â”‚  â”‚    - refreshBalance(): Trigger re-fetch            â”‚â”‚
â”‚  â”‚                                                     â”‚â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚â”‚
â”‚  â”‚  â”‚  useEffect(() => fetchBalance(), [])      â”‚   â”‚â”‚
â”‚  â”‚  â”‚  Runs on mount                            â”‚   â”‚â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚â”‚
â”‚  â”‚                                                     â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”˜â”‚
â”‚                    â”‚                               â”‚  â”‚
â”‚                    â”‚ Provides context              â”‚  â”‚
â”‚                    â”‚                               â”‚  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”˜
                     â”‚                               â”‚
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                      â”‚        â”‚                     â”‚
         â”‚   Navbar.jsx         â”‚        â”‚  FlightCard.jsx     â”‚
         â”‚                      â”‚        â”‚                     â”‚
         â”‚  const { balance,    â”‚        â”‚  const {            â”‚
         â”‚          loading }   â”‚        â”‚    refreshBalance   â”‚
         â”‚  = useWallet()       â”‚        â”‚  } = useWallet()    â”‚
         â”‚                      â”‚        â”‚                     â”‚
         â”‚  Display balance     â”‚        â”‚  After booking:     â”‚
         â”‚  in nav bar          â”‚        â”‚  refreshBalance()   â”‚
         â”‚                      â”‚        â”‚                     â”‚
         â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                                   â”‚
                                                   â”‚
                                                   â–¼
                                        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                                        â”‚  Balance updates    â”‚
                                        â”‚  across all comps   â”‚
                                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ›¡ï¸ Error Handling Architecture

```
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚  API REQUEST     â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
                            â”‚
                   â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                   â”‚   TRY BLOCK      â”‚
                   â”‚  Execute logic   â”‚
                   â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â”‚
              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
              â”‚                           â”‚
         SUCCESS                       ERROR
              â”‚                           â”‚
              â–¼                           â–¼
    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”‚  RETURN SUCCESS  â”‚       â”‚   CATCH BLOCK    â”‚
    â”‚  { success:true, â”‚       â”‚  Log error       â”‚
    â”‚    data:... }    â”‚       â”‚                  â”‚
    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                        â”‚
                                        â–¼
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚  RETURN ERROR    â”‚
                              â”‚  { success:false,â”‚
                              â”‚    message:...,  â”‚
                              â”‚    error:... }   â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                       â”‚
                                       â–¼
                              â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                              â”‚  FRONTEND        â”‚
                              â”‚  if (!success):  â”‚
                              â”‚    alert(message)â”‚
                              â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“± Responsive Design Breakpoints

```
Mobile         Tablet         Desktop        Wide
(< 640px)      (640-1024px)   (1024-1440px)  (> 1440px)
   â”‚              â”‚              â”‚              â”‚
   â”‚              â”‚              â”‚              â”‚
   â”œâ”€â–¶ Stack      â”œâ”€â–¶ 2 cols    â”œâ”€â–¶ 3 cols    â”œâ”€â–¶ 3 cols
   â”‚   vertically â”‚   grid       â”‚   grid       â”‚   + margins
   â”‚              â”‚              â”‚              â”‚
   â”œâ”€â–¶ Full width â”œâ”€â–¶ Padding   â”œâ”€â–¶ Container â”‚
   â”‚   cards      â”‚   16px       â”‚   1200px    â”‚
   â”‚              â”‚              â”‚              â”‚
   â””â”€â–¶ Hide some  â””â”€â–¶ Show all  â””â”€â–¶ Show all  â””â”€â–¶ Show all
       details        details      + enhanced      + enhanced
```

---

**This architecture enables a scalable, maintainable, and production-ready application.** âœ¨
